fun cat with l1, l2 =
    if (isNil l1) then
        l2
    else
        let head = !l1 in
        let tail = #l1 in
        head @ (cat tail l2)
in


fun filter with list, func =
    if (isNil list) then
        Nil
    else
        let head = !list in
        let tail = #list in
        let filtertail = (filter tail func) in
        let accepthead = head @ filtertail in
        (func head accepthead filtertail)
in

fun isLess with x, y, true, false =
    if (y < x) then
        true
    else
        false
in

fun isGreaterOrEq with x, y, true, false =
    if (y >= x) then
        true
    else
        false
in

fun quicksort with list =
    if (isNil list) then
        Nil
    else
        let pivot = !list in
        let tail = #list in
        let gf = (isGreaterOrEq pivot) in
        let glist = (filter tail gf) in
        let lf = (isLess pivot) in
        let llist = (filter tail lf) in
        let sortedbegin = (quicksort glist) in
        let sortedend = (quicksort llist) in
        (cat sortedbegin (cat pivot sortedend))
in
let listy = (891@231@134@234@913@755@146@447@602@453@892@682@724@484@305@750@849@421@825@553@889@148@97@564@99@109@369@912@228@877@75@938@425@496@688@343@920@291@478@6@246@249@800@347@204@192@865@16@962@576@619@670@513@505@539@33@861@523@685@487@509@481@492@383@524@491@353@744@8@530@638@908@522@167@334@697@161@571@158@290@937@922@639@833@302@819@765@585@857@887@502@387@254@386@687@330@73@980@377@235@136@945@184@720@758@166@83@903@886@40@742@300@680@511@794@694@541@454@854@627@762@280@803@760@28@809@92@582@873@111@4@772@493@240@921@285@211@418@242@517@86@557@124@233@605@201@653@100@319@752@376@545@220@325@572@830@599@683@663@276@448@423@924@214@610@114@202@747@460@96@10@375@932@333@828@623@400@500@631@916@315@457@181@870@54@392@982@20@30@952@941@584@278@673@55@441@880@345@586@3@732@482@622@532@24@721@556@928@845@133@872@698@248@508@969@150@356@417@105@405@442@346@328@18@563@807@433@676@123@554@271@944@885@832@63@862@208@206@858@507@295@98@200@654@155@416@309@153@212@407@888@802@141@961@465@17@681@978@13@395@519@422@287@81@60@452@909@781@835@611@992@95@656@996@470@65@74@718@814@767@609@520@919@223@657@581@644@115@118@860@578@618@455@960@911@959@655@917@177@384@294@949@855@988@617@297@882@785@561@782@788@550@266@823@783@540@456@717@162@754@226@267@77@749@265@46@686@895@745@225@34@48@934@458@661@410@548@547@813@883@189@510@971@140@406@125@577@543@568@741@846@516@476@757@238@936@925@272@203@999@816@866@770@9@348@544@251@751@808@113@840@848@243@259@598@904@373@209@735@385@175@218@84@219@743@612@806@71@534@44@88@180@810@29@650@360@14@914@953@446@690@987@340@703@468@227@370@138@787@312@729@412@464@132@445@868@725@972@365@821@679@779@535@711@332@768@566@39@527@306@970@555@104@756@994@874@927@851@174@546@409@608@121@893@512@91@282@901@431@636@764@812@388@791@298@25@968@789@746@704@604@973@837@689@790@773@469@270@257@27@323@224@896@326@471@402@671@307@531@139@420@592@842@637@829@859@79@286@393@358@603@995@726@626@933@237@662@699@930@94@116@647@706@613@769@974@247@216@362@322@906@899@792@374@122@401@435@997@159@428@664@811@734@954@429@485@178@963@263@506@625@229@351@320@669@329@929@514@537@279@820@232@145@696@560@587@983@230@569@327@352@339@624@841@616@946@129@591@776@739@796@144@413@691@780@910@45@881@902@354@597@552@296@199@127@490@786@595@818@884@503@331@253@826@210@135@191@993@261@905@990@964@702@262@304@558@318@41@695@434@31@575@831@707@245@640@827@839@357@606@255@19@723@708@56@359@404@998@324@163@549@869@152@498@382@847@715@497@766@674@463@979@301@713@630@379@303@42@620@967@784@85@856@495@472@588@147@451@986@37@157@49@926@288@793@529@955@731@976@804@314@646@489@394@380@193@649@70@67@185@836@771@641@415@665@501@188@852@151@733@844@160@918@350@381@483@426@714@107@398@311@182@684@310@473@11@293@678@871@778@628@950@966@103@399@126@268@50@172@722@260@915@1@570@419@834@363@693@705@590@475@130@596@355@879@250@525@876@759@149@740@528@675@292@308@801@774@390@736@256@361@583@364@222@943@35@341@173@666@985@607@213@898@710@499@391@106@367@716@38@112@692@738@822@488@567@538@72@80@878@7@411@562@371@850@316@131@321@93@432@536@396@108@12@719@900@565@52@47@521@283@281@977@958@462@110@975@573@594@179@337@449@799@461@805@984@863@197@439@427@817@494@275@424@241@652@66@444@864@614@171@542@940@82@119@273@349@57@23@438@477@615@867@217@672@397@645@430@190@317@700@795@21@466@633@947@165@730@403@677@196@117@143@777@183@277@480@824@299@154@59@956@601@142@748@0@90@89@156@378@258@981@289@284@459@335@798@137@274@443@32@600@164@221@838@78@187@236@515@989@642@551@244@643@198@43@440@907@931@264@62@957@659@621@753@761@344@61@486@634@2@26@951@875@87@186@408@389@436@942@76@342@58@658@580@890@366@168@69@414@22@128@176@709@338@479@64@450@207@559@939@101@68@336@574@701@169@372@648@368@205@948@728@815@843@269@727@15@660@504@36@965@5@518@629@651@53@170@923@533@797@853@635@195@526@239@467@120@313@632@667@579@593@894@474@589@51@668@252@763@712@775@897@194@437@935@102@215@737@991)
in (quicksort listy)
